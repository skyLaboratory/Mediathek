<?php
/** 
*Autor: Leon Bergmann & Florian Giller
*Datum: unbekannt 	
*Zweck: Such Menü für Filme
*/
/**
	include "connect";
	$sql = "Select Titel from Filme";
	$res = mysql_query($sql) or die ("<p id='warnings'>Keine Verbindung zur Mediathek</p>");
	$filmData = mysql_fetch_array($res);
* Aus Testgründen wird hier ein vordefiniertes  Array verwendet später werden die Daten aus der DB geladen 
*/


$filmData = array("James Bond - Goldfinger","Resident Evil","Underworld","Balde","Lion","Terminator","Back to the Futur","Hot Fuzz", "Back to Karkand", "BF3", "iAm Legend", "Terminator");
$json = json_encode($filmData);

?>
	<script>
		$(function() {
			// Übernimmt die Daten des mit JSON codierten Array aus dem PHP CODE
			var json = '<?= $json ?>';
 			// Brücke zwischen PHP und JavaScript (clientseitig)
			var data = eval('(' + json + ')');
			
			var availableTags = data;
			$( "#tags" ).autocomplete({
					source: availableTags
				});
			});
	</script>
	<!-- Durch AJAX Funktion Abgelöst
	<script>
	function speichern(){
	 	var film = document.getElementById("tags").value;
	 	document.getElementById("id").value = film;
	 	document.Film.submit();
	}
	</script>
	-->
	<script>
	// Neue Javascript Funktion mit AJAX [http://de.wikipedia.org/wiki/Ajax_%28Programmierung%29]
	function mi(){
		// Name des Films aus der Autovervollständigung
		var film = document.getElementById("tags").value; 
	    // Neue Variable
		var params  = "ajax=1&film="+film;
		// Ziel Datei
		var url = "filme.php";
		// Erstellen des Requests
		var http = new XMLHttpRequest();
		// Verbindung definieren
		http.open("POST", url, true);

		// Header Informationen setzen
		http.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
		http.setRequestHeader("Content-length", params.length);
		http.setRequestHeader("Connection", "close");
		http.onreadystatechange = function() {//Call a function when the state changes.
			// Wenn die Rückgabe der Date dem readyState 4 und dem https status 200 entspricht wird 
			// die Rückgabe in die <div> Ausgabe geschrieben
			if(http.readyState == 4 && http.status == 200) {
				
				document.getElementById("Ausgabe").innerHTML = http.responseText;
			}
		}
		// Abschicken der des Requesrts
		http.send(params);
		};
	</script>
	
	<!-- Scuhfeld Definition -->
	<div style="margin-top:120px;">
		<label for="tags">Tags: </label>
		<input id="tags" name="film"/>
		<input type="submit" value="Absenden" onclick="mi()">
	</div>
	<div id="Ausgabe"></div>
	<!--ALTEWR CODE NICHT BEACHTEN
	Versteckes Formular in dem die Werte an die filme.php übergeben werden, als zwischen Schritt und um das Menü eibinden zukönnen wird die main.php als target eingetragen 
	<form name="Film" action="main.php" />
		<input type="hidden" name="film" id="id" />
		<input type="hidden" name="work" value="filme" />
		<input type="hidden" name="dev" value="1"/>
	</form>
	-->








<!-- ALTER CODE NICHT ZU BEACHTEN -->
<!--<h1>
	Suchen Sie einen Film aus</h1>
<table border="0" cellpadding="1" cellspacing="1" style="width: 561px; height: 146px;">
	<tbody>
		<tr>
			<td style="text-align: right;">
				<h4>
					Filmtitel:<br />
					<input maxlength="50" name="Name" size="24" type="Text" /></h4>
				<h4>
					<br />
					Genre:<br />
					<input maxlength="50" name="Genre" size="24" type="Text" /></h4>
			</td>
			<td>
				<p style="margin-left: 80px;">
					<input name="FSK" type="radio" value="6" />FSK ab 6</p>
				<p style="margin-left: 80px;">
					<input name="FSK" type="radio" value="12" />FSK ab 12</p>
				<p style="margin-left: 80px;">
					<input name="FSK" type="radio" value="16" />FSK ab 16</p>
				<p style="margin-left: 80px;">
					<input name="FSK" type="radio" value="18" />FSK ab 18</p>
			</td>
		</tr>
	</tbody>
</table>
<h4 style="margin-left: 120px;">
	Bewertung:</h4>
<p style="margin-left: 120px;">
	<input name="Bewertung" type="radio" value="5" />*****</p>
<p style="margin-left: 120px;">
	<input name="Bewertung" type="radio" value="4" />****</p>
<p style="margin-left: 120px;">
	<input name="Bewertung" type="radio" value="3" />***</p>
<p style="margin-left: 120px;">
	<input name="Bewertung" type="radio" value="2" />**</p>
<p style="margin-left: 120px;">
	<input name="Bewertung" type="radio" value="1" />*</p>
<p style="margin-left: 120px;">
	&nbsp;</p>
<p style="margin-left: 120px;">
	<input name="Submit" type="submit" value="Film zeigen" /></p>
	<input type="hidden" name="film" value="/mediathek/uploads/video.mp4">
-->
